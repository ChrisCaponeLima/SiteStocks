<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infogr√°fico: Meu Investimento - Cida Miranda</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #F3F4F6;
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 40vh;
            width: 100%;
            max-height: 400px;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
            color: #1E3A8A;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        
        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-bold text-[#1E3A8A] mb-2">Meu Investimento: Cida Miranda</h1>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto">Visualize a evolu√ß√£o do seu investimento de R$10.000,00 desde Outubro de 2024, comparado com a poupan√ßa.</p>
        </header>
        
        <main class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">

            <section class="card lg:col-span-3 text-center">
                <h2 class="text-2xl font-bold mb-4">Dados do Investimento</h2>
                <div class="flex flex-col md:flex-row justify-center items-center gap-8">
                    <div class="p-6 rounded-lg bg-blue-50 w-full md:w-1/3">
                        <p class="text-5xl font-bold text-blue-600 mb-2">üë§</p>
                        <h3 class="font-semibold text-lg">Investidor(a)</h3>
                        <p class="text-2xl font-bold">Cida Miranda</p>
                    </div>
                    <div class="p-6 rounded-lg bg-teal-50 w-full md:w-1/3">
                        <p class="text-5xl font-bold text-teal-600 mb-2">üí∞</p>
                        <h3 class="font-semibold text-lg">Valor Inicial</h3>
                        <p class="text-2xl font-bold">R$ 10.000,00</p>
                    </div>
                    <div class="p-6 rounded-lg bg-yellow-50 w-full md:w-1/3">
                        <p class="text-5xl font-bold text-yellow-600 mb-2">üóìÔ∏è</p>
                        <h3 class="font-semibold text-lg">Per√≠odo</h3>
                        <p class="text-2xl font-bold">23/10/2024 at√© 24/06/2025</p>
                    </div>
                </div>
            </section>

            <section class="card md:col-span-2 lg:col-span-3">
                 <h2 class="text-2xl font-bold text-center mb-2">Crescimento do seu Investimento</h2>
                 <p class="text-center text-gray-600 mb-6">A linha azul mostra o crescimento do seu Fundo de Investimento (4% a.m.), enquanto a linha verde-√°gua exibe a Poupan√ßa (0,5% a.m.) no mesmo per√≠odo.</p>
                <div class="chart-container">
                    <canvas id="growthLineChart"></canvas>
                </div>
            </section>
            
            <section class="card bg-[#2563EB] text-white">
                <h3 class="font-bold text-xl text-center mb-2">Valor Atual: Fundo</h3>
                <p class="text-center text-blue-100 mb-4">Em 24/06/2025</p>
                <p id="fundCurrentValue" class="text-5xl font-bold text-center"></p>
            </section>

            <section class="card bg-[#0D9488] text-white">
                <h3 class="font-bold text-xl text-center mb-2">Valor Atual: Poupan√ßa</h3>
                <p class="text-center text-teal-100 mb-4">Em 24/06/2025</p>
                <p id="poupancaCurrentValue" class="text-5xl font-bold text-center"></p>
            </section>

            <section class="card">
                <h2 class="text-2xl font-bold text-center mb-2">Composi√ß√£o do seu Fundo</h2>
                <p class="text-center text-gray-600 mb-6">Este gr√°fico ilustra a propor√ß√£o entre o capital inicial e os rendimentos acumulados no seu Fundo de Investimento.</p>
                <div class="chart-container h-[45vh] max-h-[450px]">
                    <canvas id="compositionDonutChart"></canvas>
                </div>
            </section>

            <section class="card md:col-span-2 lg:col-span-3">
                <h2 class="text-2xl font-bold text-center mb-4">Detalhes M√™s a M√™s do seu Patrim√¥nio</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-left">
                        <thead>
                            <tr class="border-b-2 border-[#1E3A8A]">
                                <th class="p-3 font-semibold">M√™s</th>
                                <th class="p-3 font-semibold">Fundo de Investimento</th>
                                <th class="p-3 font-semibold">Poupan√ßa</th>
                                <th class="p-3 font-semibold">Diferen√ßa de Ganhos</th>
                            </tr>
                        </thead>
                        <tbody id="comparisonTableBodyCida">
                        </tbody>
                    </table>
                </div>
            </section>

            <section class="card lg:col-span-3 text-center">
                <h2 class="text-2xl font-bold mb-4">An√°lise Personalizada do seu Investimento</h2>
                <p class="text-gray-600 mb-4">Clique abaixo para obter insights, sugest√µes de aportes mensais e uma proje√ß√£o motivacional sobre o seu investimento!</p>
                <button id="generateAnalysisBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300 ease-in-out transform hover:scale-105">
                    Gerar An√°lise Personalizada ‚ú®
                </button>
                <div id="analysisResult" class="mt-6 p-4 bg-blue-50 rounded-lg text-left text-gray-800 hidden">
                    <p id="analysisText" class="mb-2"></p>
                    <div id="loadingSpinner" class="hidden text-center">
                        <div class="animate-spin inline-block w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full"></div>
                        <p class="text-blue-600 mt-2">Gerando an√°lise...</p>
                    </div>
                </div>
            </section>

            <footer class="card lg:col-span-3 text-center bg-gray-800 text-white">
                 <h2 class="text-2xl font-bold mb-2">Seu Dinheiro Trabalhando para Voc√™!</h2>
                 <p class="text-gray-300 max-w-3xl mx-auto">A jornada do seu investimento demonstra claramente como a escolha certa e a consist√™ncia podem impulsionar seu patrim√¥nio. Continue acompanhando e investindo com intelig√™ncia!</p>
            </footer>

        </main>
    </div>

    <script>
        const formatCurrency = (value) => {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(value);
        };
        
        const initialInvestment = 10000;
        const monthlyContribution = 0;
        const fundRate = 0.04; // Updated to 4% per month
        const poupancaRate = 0.005; // 0.5% per month
        
        const startDate = new Date(2024, 9, 23); // Month is 0-indexed (Oct is 9)
        const endDate = new Date(2025, 5, 24); // Month is 0-indexed (June is 5)
        
        let monthsElapsed = 0;
        let currentDate = new Date(startDate);
        const labels = ['Out/24 (In√≠cio)'];
        const fundHistory = [initialInvestment];
        const poupancaHistory = [initialInvestment];
        const tableRows = [];

        let currentFundValue = initialInvestment;
        let currentPoupancaValue = initialInvestment;

        while (currentDate.setMonth(currentDate.getMonth() + 1) <= endDate) {
            monthsElapsed++;
            const monthLabel = `${currentDate.toLocaleString('pt-BR', { month: 'short' })}/${currentDate.getFullYear().toString().slice(-2)}`;
            labels.push(monthLabel.charAt(0).toUpperCase() + monthLabel.slice(1));

            let fundValueBeforeInterest = currentFundValue;
            let poupancaValueBeforeInterest = currentPoupancaValue;

            currentFundValue *= (1 + fundRate);
            currentPoupancaValue *= (1 + poupancaRate);

            fundHistory.push(currentFundValue);
            poupancaHistory.push(currentPoupancaValue);

            const fundEarnings = currentFundValue - fundValueBeforeInterest;
            const poupancaEarnings = currentPoupancaValue - poupancaValueBeforeInterest;

            tableRows.push({
                month: monthsElapsed,
                fundDisplay: formatCurrency(currentFundValue),
                poupancaDisplay: formatCurrency(currentPoupancaValue),
                diffDisplay: formatCurrency(fundEarnings - poupancaEarnings)
            });
        }
        
        labels[labels.length - 1] = labels[labels.length - 1] + ' (Atual)';

        document.getElementById('fundCurrentValue').textContent = formatCurrency(currentFundValue);
        document.getElementById('poupancaCurrentValue').textContent = formatCurrency(currentPoupancaValue);
        
        const tableBodyCida = document.getElementById('comparisonTableBodyCida');
        tableRows.forEach(row => {
            tableBodyCida.innerHTML += `
                <tr class="border-b border-gray-200 hover:bg-gray-50">
                    <td class="p-3">${row.month}</td>
                    <td class="p-3">${row.fundDisplay}</td>
                    <td class="p-3">${row.poupancaDisplay}</td>
                    <td class="p-3 text-green-600 font-semibold">${row.diffDisplay}</td>
                </tr>
            `;
        });
        
        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            }
            return label;
        };
        
        const growthLineChartCtx = document.getElementById('growthLineChart').getContext('2d');
        new Chart(growthLineChartCtx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Fundo de Investimento',
                    data: fundHistory,
                    borderColor: '#2563EB',
                    backgroundColor: 'rgba(37, 99, 235, 0.1)',
                    fill: true,
                    tension: 0.3
                }, {
                    label: 'Poupan√ßa',
                    data: poupancaHistory,
                    borderColor: '#0D9488',
                    backgroundColor: 'rgba(13, 148, 136, 0.1)',
                    fill: true,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        ticks: {
                            callback: function(value, index, values) {
                                return formatCurrency(value);
                            }
                        }
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            title: tooltipTitleCallback,
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed.y !== null) {
                                    label += formatCurrency(context.parsed.y);
                                }
                                return label;
                            }
                        }
                    }
                }
            }
        });

        const totalEarnings = currentFundValue - initialInvestment;
        const compositionDonutChartCtx = document.getElementById('compositionDonutChart').getContext('2d');
        new Chart(compositionDonutChartCtx, {
            type: 'doughnut',
            data: {
                labels: ['Capital Inicial', 'Rendimentos'],
                datasets: [{
                    data: [initialInvestment, totalEarnings],
                    backgroundColor: ['#1E3A8A', '#FBBF24'],
                    borderColor: '#FFFFFF',
                    borderWidth: 4,
                    hoverOffset: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '60%',
                plugins: {
                    legend: {
                        position: 'bottom',
                    },
                    tooltip: {
                        callbacks: {
                            title: tooltipTitleCallback,
                            label: function(context) {
                                let label = context.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed !== null) {
                                    label += formatCurrency(context.parsed);
                                }
                                return label;
                            }
                        }
                    }
                }
            }
        });

        // LLM Integration
        document.getElementById('generateAnalysisBtn').addEventListener('click', async () => {
            const analysisResultDiv = document.getElementById('analysisResult');
            const analysisTextP = document.getElementById('analysisText');
            const loadingSpinner = document.getElementById('loadingSpinner');

            analysisResultDiv.classList.remove('hidden');
            analysisTextP.classList.add('hidden');
            loadingSpinner.classList.remove('hidden');

            const prompt = `Com base nos dados de investimento de Cida Miranda:
- Investimento Inicial: R$ ${initialInvestment.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
- Taxa de Rendimento Mensal do Fundo: ${fundRate * 100}%
- Per√≠odo total de investimento: ${monthsElapsed} meses (de 23/10/2024 a 24/06/2025)
- Valor Atual do Fundo: R$ ${currentFundValue.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}

Gere uma breve an√°lise personalizada do desempenho deste investimento.
1. Destaque: A import√¢ncia da taxa de juros e do tempo, usando os valores reais de Cida para ilustrar.
2. Sugest√µes de Aportes Mensais: Inclua sugest√µes de aportes mensais, como R$50, R$100, R$200, explicando o impacto qualitativo de cada um no crescimento do patrim√¥nio (por exemplo, "aceleraria ainda mais o seu crescimento", "ampliaria significativamente seu patrim√¥nio", "potencializaria seus ganhos"). N√£o calcule valores exatos de proje√ß√£o, mas enfatize a ideia de acelera√ß√£o e potencial.
3. Proje√ß√£o Motivacional (Curta): Uma frase sobre o potencial de crescimento futuro se o investimento for mantido e com aportes consistentes.
4. Tom: Encorajador e informativo.
5. Formato: Um par√°grafo coeso.`;

            try {
                const chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = ""; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    analysisTextP.textContent = text;
                } else {
                    analysisTextP.textContent = "N√£o foi poss√≠vel gerar a an√°lise. Tente novamente.";
                }
            } catch (error) {
                console.error("Erro ao chamar a API do Gemini:", error);
                analysisTextP.textContent = "Ocorreu um erro ao gerar a an√°lise. Verifique sua conex√£o ou tente novamente mais tarde.";
            } finally {
                loadingSpinner.classList.add('hidden');
                analysisTextP.classList.remove('hidden');
            }
        });
    </script>
</body>
</html>
